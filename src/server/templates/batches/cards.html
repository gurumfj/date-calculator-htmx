{% for batch in batches %}
<div class="bg-white rounded-lg shadow-md hover:shadow-lg transition-shadow duration-200 p-6 border border-gray-200">
    <div class="flex justify-between items-start mb-4">
        <h3 class="text-lg font-semibold text-blue-600">{{ batch.batch_name }}</h3>
        <span class="text-sm bg-gray-100 text-gray-700 px-2 py-1 rounded">{{ batch.chicken_breed }}</span>
    </div>
    
    <div class="grid grid-cols-2 gap-4 mb-4">
        <div>
            <div class="text-xs text-gray-500 mb-1">繁殖日期</div>
            <div class="text-sm font-medium">{{ batch.breed_date }}</div>
        </div>
        <div>
            <div class="text-xs text-gray-500 mb-1">到期日</div>
            <div class="text-sm font-medium">{{ batch.expire_date }}</div>
        </div>
        <div>
            <div class="text-xs text-gray-500 mb-1">日齡 / 週齡</div>
            <div class="text-sm font-medium">{{ batch.dayage }} / {{ batch.week_age }}</div>
        </div>
        <div>
            <div class="text-xs text-gray-500 mb-1">銷售率</div>
            <div class="text-sm font-medium">{{ "%.1f"|format(batch.percentage) }}%</div>
        </div>
    </div>
    
    <div class="grid grid-cols-3 gap-2 mb-4 text-center">
        <div class="bg-blue-50 rounded p-2">
            <div class="text-xs text-gray-500">公雞</div>
            <div class="text-sm font-semibold text-blue-600">{{ batch.total_b_male }}</div>
        </div>
        <div class="bg-pink-50 rounded p-2">
            <div class="text-xs text-gray-500">母雞</div>
            <div class="text-sm font-semibold text-pink-600">{{ batch.total_b_female }}</div>
        </div>
        <div class="bg-green-50 rounded p-2">
            <div class="text-xs text-gray-500">已售</div>
            <div class="text-sm font-semibold text-green-600">{{ batch.total_count }}</div>
        </div>
    </div>
    
    <div class="grid grid-cols-2 gap-4 text-sm">
        <div>
            <span class="text-gray-500">剩餘:</span>
            <span class="font-medium">{{ batch.sales_remain_male }}</span>
        </div>
        <div>
            <span class="text-gray-500">FCR:</span>
            <span class="font-medium">{{ "%.2f"|format(batch.fcr) if batch.fcr else "-" }}</span>
        </div>
    </div>
    
    {% if batch.feed %}
    <div class="mt-3 pt-3 border-t border-gray-100">
        <div class="text-xs text-gray-500 mb-1">飼料</div>
        <div class="text-sm">{{ batch.feed }}</div>
    </div>
    {% endif %}
    
    {% if batch.sales_open_date or batch.sales_last_date %}
    <div class="mt-3 pt-3 border-t border-gray-100">
        <div class="grid grid-cols-2 gap-2 text-xs">
            {% if batch.sales_open_date %}
            <div>
                <span class="text-gray-500">開始銷售:</span>
                <div class="font-medium">{{ batch.sales_open_date }}</div>
            </div>
            {% endif %}
            {% if batch.sales_last_date %}
            <div>
                <span class="text-gray-500">最後銷售:</span>
                <div class="font-medium">{{ batch.sales_last_date }}</div>
            </div>
            {% endif %}
        </div>
    </div>
    {% endif %}
</div>
{% endfor %}

{% if has_more %}
<div 
    hx-get="/batches/data?chicken_breed={{ chicken_breed or '古早' }}{% if batch_name %}&batch_name={{ batch_name }}{% endif %}&view=cards&limit=20&offset={{ next_offset }}"
    hx-trigger="revealed"
    hx-swap="outerHTML"
    class="w-full h-20 flex items-center justify-center">
    <div class="text-gray-500">載入更多...</div>
</div>
{% endif %}